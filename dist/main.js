"use strict";var config={content:{folder:"content"}},utils={wait:async e=>new Promise(t=>setTimeout(t,e)),isRelativeUrl:e=>e.indexOf("://")<1&&0!==e.indexOf("//"),stripLeadingSlash:e=>0===e.indexOf("/")?e.substring(1):e,isMac:()=>window.navigator.appVersion.includes("Mac"),createUrlFromPath:e=>{let t=utils.stripLeadingSlash(e);return""===t&&(t="index"),`${config.content.folder}/${t}.html`},async getHtmlFromUrl(e){const t=await fetch(e);if(t.status>=400&&t.status<600)throw new Error("File not found");return await t.text()},setActiveLinksInNav:()=>{const e=[...elements.nav.querySelectorAll("a")];e.filter(e=>utils.stripLeadingSlash(e.getAttribute("href"))===utils.stripLeadingSlash(route.path)).forEach(e=>{e.classList.add("active-link")}),e.filter(e=>utils.stripLeadingSlash(e.getAttribute("href"))!==utils.stripLeadingSlash(route.path)).forEach(e=>{e.classList.remove("active-link")})}},elements={_elements:{},setElement:(e,t)=>elements._elements[e]=document.querySelector(t),get body(){return elements._elements.body||elements.setElement("body","body")},get nav(){return elements._elements.nav||elements.setElement("nav","#nav")},get contentNode(){return elements._elements.contentNode||elements.setElement("contentNode","#content")}},route={get path(){return window.location.pathname},set path(e){route.path!==e&&history.pushState("",e,e)}},nodes={addChild:(e,t)=>e.appendChild(t),removeChildren:e=>{for(;e.firstChild;)e.firstChild.remove()},createNodesFromHtml:e=>{const t=document.createElement("template");return t.innerHTML=e,t.content.childNodes},replaceNodesFromHtml:(e,t)=>{nodes.removeChildren(e),nodes.createNodesFromHtml(t).forEach(t=>nodes.addChild(e,t))}},load={async content(e){const t=utils.createUrlFromPath(e),n=await utils.getHtmlFromUrl(t).catch(t=>{if("/404"!==e)return load.content("/404");throw new Error(t)});n&&(elements.body.classList.add("fade"),await utils.wait(320),nodes.replaceNodesFromHtml(elements.contentNode,n),route.path=e,elements.body.classList.remove("fade"))},async nav(){const e=utils.createUrlFromPath("/nav"),t=await utils.getHtmlFromUrl(e).catch(e=>{throw new Error(e)});t&&nodes.replaceNodesFromHtml(elements.nav,t)}},hooks={onLoad:()=>{const e=performance.now();Promise.all([load.content(route.path),load.nav()]).then(()=>{utils.setActiveLinksInNav();const t=performance.now()-e;t>1e3?elements.body.classList.remove("splash-loading"):setTimeout(()=>{elements.body.classList.remove("splash-loading")},4e3-t)})},onclick:e=>{if(e.clientX&&e.clientY&&elements.body.classList.remove("keyboard-nav"),!e.target.matches("a"))return;const t=e.target.getAttribute("href");if(t&&utils.isRelativeUrl(t)){const n=utils.isMac()&&e.metaKey||!utils.isMac()&&e.ctrlKey,o=e.shiftKey;if(n||o)return;e.preventDefault(),elements.nav.querySelector("input").checked=!1,load.content(t).then(()=>{utils.setActiveLinksInNav()})}},onpopstate:e=>{e.preventDefault(),load.content(route.path).then(()=>{utils.setActiveLinksInNav()})},onkeyup:e=>{9===e.which&&elements.body.classList.add("keyboard-nav"),27===e.which&&elements.nav.querySelector("input").checked&&(elements.nav.querySelector("input").checked=!1)}};window.onload=hooks.onLoad,window.onclick=hooks.onclick,window.onpopstate=hooks.onpopstate,window.onkeyup=hooks.onkeyup;
